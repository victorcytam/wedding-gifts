<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hannah & Victor 22.11.2025</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
      background: #FAF85F; 
      min-height:100vh; 
    }
    .container { max-width: 100%; margin: 0 auto; padding: 20px 15px; }

    /* Header */
    h1 { text-align:center; color:#E6CAC3; font-size:28px; margin:20px 0 8px; font-weight:600; }
    .date { text-align:center; color:#A2B6A7; font-size:19px; margin-bottom:25px; }

    /* Thanks */
    .thanks {
      background:#fff; padding:22px; border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,0.08);
      margin:20px 0; text-align:center; line-height:1.9; font-size:16px; color:#555;
    }
    .thanks strong { color:#E6CAC3; font-size:19px; }

    /* Gifts */
    .gift { 
      border-radius:18px; padding:18px; margin:18px 0; display:flex; align-items:center;
      background:#fff; box-shadow:0 8px 25px rgba(0,0,0,0.09); transition:all 0.2s;
    }
    .gift:active { transform:scale(0.98); }
    .gift img { 
      width:96px; height:96px; object-fit:cover; border-radius:15px; margin-right:16px; 
      flex-shrink:0; background:#f0f0f0;
    }
    .gift .info { flex:1; }
    .gift .price { font-weight:bold; color:#A2B6A7; font-size:19px; }
    .gift button { 
      background:#E6CAC3; color:white; border:none; padding:13px 24px; 
      border-radius:50px; cursor:pointer; font-size:15px; font-weight:500; min-width:120px;
    }
    .gift button:active { background:#d6b8b1; }

    .redpocket { border: 3px solid #A2B6A7 !important; background: #f9fff9 !important; }

    /* Modal */
    .modal { padding:15px; overflow-y:auto; -webkit-overflow-scrolling:touch; }
    .modal-content { 
      border-radius:22px; padding:28px 22px; max-width:90%; margin:auto; 
      background:#fff; max-height:90vh; overflow-y:auto; 
    }
    .close { float:right; font-size:28px; cursor:pointer; color:#aaa; }

    #step-details img { width:100px; height:100px; object-fit:cover; border-radius:15px; margin-bottom:15px; cursor:zoom-in; }
    #proceed-btn { background:#E6CAC3; color:white; padding:16px; border-radius:50px; font-size:17px; width:100%; margin-top:20px; border:none; }

    .input-group { margin:18px 0; }
    .input-group input, .input-group textarea {
      width:100%; padding:16px; border-radius:50px; border:1px solid #ddd; 
      font-size:17px; text-align:center; resize:none;
    }
    .input-group textarea { height:100px; }

    #confirm-btn { background:#A2B6A7; color:white; padding:16px; border-radius:50px; font-size:17px; width:100%; border:none; margin-top:15px; }

    /* Tabs */
    .tabs { display:flex; justify-content:center; margin:40px 0 20px; gap:15px; }
    .tab { padding:12px 24px; border-radius:50px; background:#fff; color:#A2B6A7; font-weight:600; cursor:pointer; }
    .tab.active { background:#E6CAC3; color:white; }

    /* Log Table */
    #log-table { width:100%; border-collapse:collapse; margin-top:20px; }
    #log-table th, #log-table td { padding:12px; text-align:left; border-bottom:1px solid #eee; font-size:15px; }
    #log-table th { background:#f8f8f8; color:#A2B6A7; }

    .admin-btn { margin:70px auto 40px; text-align:center; }
    .admin-btn button { background:#A2B6A7; padding:11px 18px; border-radius:50px; font-size:12px; color:white; }

    /* Zoom */
    #zoom-modal { display:none; padding:0; background:rgba(0,0,0,0.95); z-index:9999; }
    #zoom-modal img { max-width:95%; max-height:95%; object-fit:contain; border-radius:12px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Hannah & Victor</h1>
    <div class="date">22 November 2025</div>

    <div class="thanks">
      <strong>親愛的家人朋友，</strong><br><br>
      感謝你們來到我們人生中最重要的一天！有你哋在場已經係最好嘅禮物～<br><br>
      Your presence is the greatest blessing. 如果你哋想再送上祝福，<br>
      以下係我哋用心準備嘅禮物清單同利是選項，隨心選擇即可<br><br>
      多謝你哋嘅愛心同支持，真係好感動！感恩有你哋！
    </div>

    <!-- TABS -->
    <div class="tabs">
      <div class="tab active" onclick="showTab('gifts')">Gifts</div>
      <div class="tab" onclick="showTab('log')">Gifting Log (Admin)</div>
    </div>

    <!-- GIFTS TAB -->
    <div id="tab-gifts">
      <h2 style="color:#E6CAC3; text-align:center; margin:40px 0 20px;">Available Gifts 可選禮物</h2>
      <div id="available"></div>

      <h2 style="color:#A2B6A7; text-align:center; margin:50px 0 20px;">Already Gifted 已送出嘅祝福</h2>
      <div id="gifted"></div>
    </div>

    <!-- LOG TAB (Password Protected) -->
    <div id="tab-log" style="display:none;">
      <h2 style="color:#E6CAC3; text-align:center; margin:40px 0 20px;">Gifting Log</h2>
      <div id="log-content"></div>
    </div>

    <!-- Claim Modal -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">×</span>

        <div id="step-details">
          <img id="modal-img" src="" alt="" onclick="zoomImage(this.src)" />
          <h3 id="modal-name"></h3>
          <p id="modal-details" style="white-space:pre-line; color:#555;"></p>
          <p style="font-size:21px; color:#A2B6A7; margin:15px 0;">
            <span id="modal-price"></span>
          </p>
          <button id="proceed-btn" onclick="showPaymentStep()">Proceed</button>
        </div>

        <div id="step-payment" style="display:none;">
          <div class="input-group">
            <input type="text" id="claimer-name" placeholder="Your name 你的名字" required />
          </div>
          <div class="input-group">
            <textarea id="blessing" placeholder="Leave a blessing (optional) 送上祝福（可選）"></textarea>
          </div>
          <button id="confirm-btn" onclick="confirmGift()">I've Gifted – Record It</button>
          <button onclick="backToDetails()" style="margin-top:10px; background:#ddd; padding:14px; border-radius:50px; width:100%; border:none;">
            ← Back
          </button>
        </div>
      </div>
    </div>

    <!-- Zoom Modal -->
    <div id="zoom-modal" class="modal">
      <div style="position:relative; width:100%; height:100%; display:flex; align-items:center; justify-content:center; padding:20px;">
        <img id="zoomed-img" src="" />
        <span onclick="closeZoom()" style="position:absolute; top:15px; right:15px; font-size:36px; color:white; cursor:pointer; background:rgba(0,0,0,0.6); border-radius:50%; width:50px; height:50px; display:flex; align-items:center; justify-content:center;">
          ×
        </span>
      </div>
    </div>

    <!-- Admin Button -->
    <div class="admin-btn">
      <button onclick="openAdminPanel()">Admin Panel (0411)</button>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    function showTab(tab) {
      if (tab === 'log') {
        const pass = prompt("Password for Gifting Log?");
        if (pass !== "0411") return alert("Wrong password!");
      }
      document.getElementById('tab-gifts').style.display = tab === 'gifts' ? 'block' : 'none';
      document.getElementById('tab-log').style.display = tab === 'log' ? 'block' : 'none';
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab')[tab === 'gifts' ? 0 : 1].classList.add('active');
      
      if (tab === 'log') renderLog();
    }

    function renderLog() {
      const logs = Object.entries(claimedData)
        .map(([id, rec]) => {
          const g = gifts.find(x => x.id == id);
          return { ...rec, giftName: g?.name || 'Unknown' };
        })
        .sort((a,b) => b.timestamp - a.timestamp);

      const html = logs.length ? `
        <table id="log-table">
          <tr><th>Gift</th><th>Name</th><th>Blessing</th><th>Time</th></tr>
          ${logs.map(l => `
            <tr>
              <td><strong>${l.giftName}</strong></td>
              <td>${l.name}</td>
              <td style="max-width:200px; word-wrap:break-word;">${l.blessing}</td>
              <td>${new Date(l.timestamp).toLocaleString()}</td>
            </tr>
          `).join('')}
        </table>
      ` : '<p style="text-align:center; color:#aaa;">No gifts recorded yet.</p>';
      
      document.getElementById('log-content').innerHTML = html;
    }

    // Modal functions
    function zoomImage(src) { document.getElementById('zoomed-img').src = src; document.getElementById('zoom-modal').style.display = 'flex'; }
    function closeZoom() { document.getElementById('zoom-modal').style.display = 'none'; }
    document.getElementById('zoom-modal').onclick = e => { if (e.target === this) closeZoom(); };
  </script>
</body>
</html>